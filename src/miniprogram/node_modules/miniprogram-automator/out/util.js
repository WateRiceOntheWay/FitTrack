"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.extractPluginId=exports.isPluginPath=exports.printQrCode=exports.decodeQrCode=void 0;const jimp_1=__importDefault(require("jimp")),startWith_1=__importDefault(require("licia/startWith")),qrCodeTerminal=require("qrcode-terminal"),QrCodeReader=require("qrcode-reader");function decodeQrCode(e){const r=new Buffer(e,"base64");return new Promise((async(e,t)=>{const i=await jimp_1.default.read(r),o=new QrCodeReader;o.callback=function(r,i){if(r)return t(r);e(i.result)},o.decode(i.bitmap)}))}function printQrCode(e){return new Promise((r=>{qrCodeTerminal.generate(e,{small:!0},(e=>{process.stdout.write(e),r()}))}))}function isPluginPath(e){return startWith_1.default(e,"plugin-private://")}exports.decodeQrCode=decodeQrCode,exports.printQrCode=printQrCode,exports.isPluginPath=isPluginPath;const regPluginId=/^plugin-private:\/\/([0-9a-zA-Z]+)\//;function extractPluginId(e){const r=e.match(regPluginId);return r?r[1]:""}exports.extractPluginId=extractPluginId;